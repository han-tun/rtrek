<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to rtrek • rtrek</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Introduction to rtrek">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-46129458-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-46129458-3');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rtrek</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/rtrek.html">Get Started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fonts.html">Star Trek fonts</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/sc.html">Stellar Cartography</a>
</li>
<li>
  <a href="../articles/rr.html">R &amp; R... &amp; R</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Online
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://github.com/leonawicz">
        <span class="fa fa-github fa-lg"></span>
         
        GitHub
      </a>
    </li>
    <li>
      <a href="https://twitter.com/leonawicz">
        <span class="fa fa-twitter fa-lg"></span>
         
        Twitter
      </a>
    </li>
    <li>
      <a href="https://www.linkedin.com/in/leonawicz">
        <span class="fa fa-linkedin fa-lg"></span>
         
        LinkedIn
      </a>
    </li>
    <li>
      <a href="https://www.youtube.com/user/StatisticsWithR">
        <span class="fa fa-youtube fa-lg"></span>
         
        YouTube
      </a>
    </li>
    <li>
      <a href="https://plus.google.com/+StatisticsWithR/posts">
        <span class="fa fa-google-plus fa-lg"></span>
         
        Google+
      </a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/blog/">
        <span class="fa fa-pencil-square-o fa-lg"></span>
         
        Blog
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/leonawicz/rtrek">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="rtrek_files/htmlwidgets-1.2/htmlwidgets.js"></script><script src="rtrek_files/jquery-1.12.4/jquery.min.js"></script><link href="rtrek_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="rtrek_files/leaflet-1.3.1/leaflet.js"></script><link href="rtrek_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="rtrek_files/Proj4Leaflet-1.0.1/proj4-compressed.js"></script><script src="rtrek_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="rtrek_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="rtrek_files/leaflet-binding-2.0.0/leaflet.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to rtrek</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/leonawicz/rtrek/blob/master/vignettes/rtrek.Rmd"><code>vignettes/rtrek.Rmd</code></a></small>
      <div class="hidden name"><code>rtrek.Rmd</code></div>

    </div>

    
    
<p>The <code>rtrek</code> package provides datasets related to the Star Trek fictional universe and functions for working with those datasets. The package interfaces with Wikipedia, the Star Trek API (STAPI), Memory Alpha and Memory Beta to retrieve data, metadata and other information relating to Star Trek. It also contains local datasets covering a variety of topics such as Star Trek universe species data, geopolitical data, and datasets resulting from text mining analyses of Star Trek novels. This introduction provides a brief, example-driven overview of <code>rtrek</code>.</p>
<div id="local-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#local-datasets" class="anchor"></a>Local datasets</h2>
<p>Package datasets in <code>rtrek</code> are somewhat eclectic and currently limited. They will expand with further package development. To list all available package datasets with a short description, call <code>st_datasets</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rtrek)
<span class="kw"><a href="../reference/st_datasets.html">st_datasets</a></span>()
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   dataset       description                             </span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;                                   </span>
<span class="co">#&gt; 1 stGeo         Map tile set locations of interest.     </span>
<span class="co">#&gt; 2 stSpecies     Basic intelligent species data.         </span>
<span class="co">#&gt; 3 stTiles       Available map tile sets.                </span>
<span class="co">#&gt; 4 stBooks       Star Trek novel metadata.               </span>
<span class="co">#&gt; 5 stBooksWP     Star Trek novel metadata from Wikipedia.</span>
<span class="co">#&gt; 6 stapiEntities Star Trek API (STAPI) categories</span></code></pre></div>
<div id="star-trek-novels" class="section level3">
<h3 class="hasAnchor">
<a href="#star-trek-novels" class="anchor"></a>Star Trek novels</h3>
<p>The <code>stBooksWP</code> dataset provides a moderately curated data frame of over 715 Star Trek books published since the early days of the Original Series episode adaptations by James Blish up through the latest novels as of the most recent <code>rtrek</code> update. <code>stBooksWP</code> is not an exhaustive account, but it is sufficiently comprehensive, containing most published books listed on Wikipedia. Those not listed were those more difficult to web scrape such as small anthologies listed in footnotes rather than in table form online.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stBooksWP
<span class="co">#&gt; # A tibble: 715 x 6</span>
<span class="co">#&gt;    Series                   Title    Author   Number Timeframe Released   </span>
<span class="co">#&gt;    &lt;chr&gt;                    &lt;chr&gt;    &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;      </span>
<span class="co">#&gt;  1 The_Original_Series - B~ Star Tr~ James B~     NA &lt;NA&gt;      1967-01-01~</span>
<span class="co">#&gt;  2 The_Original_Series - B~ Star Tr~ James B~     NA &lt;NA&gt;      1968-02-01~</span>
<span class="co">#&gt;  3 The_Original_Series - B~ Star Tr~ James B~     NA &lt;NA&gt;      1969-04-01~</span>
<span class="co">#&gt;  4 The_Original_Series - B~ Star Tr~ James B~     NA &lt;NA&gt;      1971-07-01~</span>
<span class="co">#&gt;  5 The_Original_Series - B~ Star Tr~ James B~     NA &lt;NA&gt;      1972-02-01~</span>
<span class="co">#&gt;  6 The_Original_Series - B~ Star Tr~ James B~     NA &lt;NA&gt;      1972-04-01~</span>
<span class="co">#&gt;  7 The_Original_Series - B~ Star Tr~ James B~     NA &lt;NA&gt;      1972-07-01~</span>
<span class="co">#&gt;  8 The_Original_Series - B~ Star Tr~ James B~     NA &lt;NA&gt;      1972-11-01~</span>
<span class="co">#&gt;  9 The_Original_Series - B~ Star Tr~ James B~     NA &lt;NA&gt;      1973-08-01~</span>
<span class="co">#&gt; 10 The_Original_Series - B~ Star Tr~ James B~     NA &lt;NA&gt;      1974-02-01~</span>
<span class="co">#&gt; # ... with 705 more rows</span></code></pre></div>
<p>Some curation decisions were made in compiling the data frame for <code>rtrek</code> related to the inclusion of some metadata in addition to not being a completely exhaustive list. However, the master Wikipedia page for Star Trek literature can be browsed at any time. As if that were not easy enough, <code>rtrek</code> also offers a convenience function <code>st_book_series</code> to load the page in a browser tab auto-scrolled to a specific series of interest.</p>
<p>In order to use this function effectively, first call it with no arguments. It returns a table of available series abbreviations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/st_book_series.html">st_book_series</a></span>()
<span class="co">#&gt; # A tibble: 17 x 2</span>
<span class="co">#&gt;    series                                abb       </span>
<span class="co">#&gt;    &lt;chr&gt;                                 &lt;chr&gt;     </span>
<span class="co">#&gt;  1 THe Original Series                   TOS       </span>
<span class="co">#&gt;  2 The Next Generation                   TNG       </span>
<span class="co">#&gt;  3 Deep Space Nine                       DS9       </span>
<span class="co">#&gt;  4 Voyager                               VOY       </span>
<span class="co">#&gt;  5 Enterprise                            ENT       </span>
<span class="co">#&gt;  6 Discovery                             DSC       </span>
<span class="co">#&gt;  7 New Frontier                          NF        </span>
<span class="co">#&gt;  8 Stargazer                             SG        </span>
<span class="co">#&gt;  9 IKS Gorkon/Klingon Empire             IKE       </span>
<span class="co">#&gt; 10 Titan                                 TIT       </span>
<span class="co">#&gt; 11 Vanguard                              VAN       </span>
<span class="co">#&gt; 12 Seekers                               SKR       </span>
<span class="co">#&gt; 13 Mini-series                           miniseries</span>
<span class="co">#&gt; 14 Starfleet Corps of Engineers          SCE       </span>
<span class="co">#&gt; 15 Department of Temporal Investigations DTI       </span>
<span class="co">#&gt; 16 Mirror Universe                       MIR       </span>
<span class="co">#&gt; 17 Starfleet Academy                     SFA</span></code></pre></div>
<p>Then call it with a specific acronym ID and the page will load at the desired table entry.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/st_book_series.html">st_book_series</a></span>(<span class="st">"DS9"</span>)</code></pre></div>
<p>This package data only graces the surface of Star Trek novels. A later section provides a brief introduction to Star Trek novel data compiled from text mining analyses of the actual book content. Unlike <code>stBooksWP</code>, which is limited to a metadata overview, these other datasets contain quantifiable variables much more suitable to interesting statistical analysis.</p>
</div>
<div id="spatial-maps" class="section level3">
<h3 class="hasAnchor">
<a href="#spatial-maps" class="anchor"></a>Spatial maps</h3>
<p>The <code>stTiles</code> data frame shows all available Star Trek-themed map tile sets along with metadata and attribution information. These map tiles can be used with the <code>leaflet</code> and <code>shiny</code> packages to make interactive maps situated in the Star Trek universe.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stTiles
<span class="co">#&gt; # A tibble: 2 x 8</span>
<span class="co">#&gt;   id      url    description width height tile_creator map_creator map_url</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;  </span>
<span class="co">#&gt; 1 galaxy1 https~ Geopolitic~  8000   6445 Matthew Leo~ Rob Archer  https:~</span>
<span class="co">#&gt; 2 galaxy2 https~ Geopolitic~  5000   4000 Matthew Leo~ &lt;NA&gt;        http:/~</span></code></pre></div>
<p>The list is scant at the moment, but more will come. One thing to keep in mind is these tile sets use a simple/non-geographical coordinate reference system (CRS). Clearly, they are not Earth-based, though they are spatial in more ways than one!</p>
<p>Similar to game maps, there is a sense of space, but it is a simple Cartesian coordinate system and does not use geographic projections like you may be used to working with when analyzing spatial data or making Leaflet maps. This system is much simpler, but simple does not necessarily mean easy!</p>
<p>Inspect <code>stGeo</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stGeo
<span class="co">#&gt; # A tibble: 18 x 4</span>
<span class="co">#&gt;    id      loc          col   row</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 galaxy1 Earth       2196  2357</span>
<span class="co">#&gt;  2 galaxy1 Romulus     2615  1742</span>
<span class="co">#&gt;  3 galaxy1 Qo'noS      3310  3361</span>
<span class="co">#&gt;  4 galaxy1 Breen       1004   939</span>
<span class="co">#&gt;  5 galaxy1 Ferenginar  1431  1996</span>
<span class="co">#&gt;  6 galaxy1 Cardassia   1342  2841</span>
<span class="co">#&gt;  7 galaxy1 Tholia       407  3866</span>
<span class="co">#&gt;  8 galaxy1 Tzenketh    1553  2557</span>
<span class="co">#&gt;  9 galaxy1 Talar       1039  3489</span>
<span class="co">#&gt; 10 galaxy2 Earth       2201  1595</span>
<span class="co">#&gt; 11 galaxy2 Romulus     2514  1178</span>
<span class="co">#&gt; 12 galaxy2 Qo'noS      3197  2303</span>
<span class="co">#&gt; 13 galaxy2 Breen       1228  1181</span>
<span class="co">#&gt; 14 galaxy2 Ferenginar  2026   886</span>
<span class="co">#&gt; 15 galaxy2 Cardassia   1543  1903</span>
<span class="co">#&gt; 16 galaxy2 Tholia       713  2971</span>
<span class="co">#&gt; 17 galaxy2 Tzenketh    1734  1721</span>
<span class="co">#&gt; 18 galaxy2 Talar       1338  2368</span></code></pre></div>
<p>This is another small dataset containing locations of key planets in the Star Trek universe. Notice the coordinates do not appear meaningful. There is no latitude and longitude. Instead there are row and column entries defining cells in a matrix. The matrix dimensions are defined by the pixel dimensions of source map that was used to create each tile set.</p>
<p>The coordinates are also not consistent. Source maps differ significantly. Even if they had identical pixel dimensions, which they do not, each artist’s visual rendering of the fictional universe will place locations differently in space. In this sense, every tile set has a unique coordinate reference system. For each new tile set produced, all locations of interest must be georeferenced again.</p>
<p>This is not ideal, but it gets worse. Once you have locations’ coordinates defined that map onto a particular tile set, the <code>leaflet</code> package does not work in these row and column grids. The <code>(col, row)</code> pairs need to be transformed or projected into Leaflet space. Fortunately, <code>rtrek</code> does this part for you with <code>tile_coords</code>. It takes a data frame like one returned by <code>st_tiles_data</code> with columns named <code>col</code> and <code>row</code>, as well as the name of an available Star Trek map tile set. It returns a data frame with new columns <code>x</code> and <code>y</code> that will map properly in a <code>leaflet</code> map built on that tile set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">id &lt;-<span class="st"> "galaxy1"</span>
(d &lt;-<span class="st"> </span><span class="kw"><a href="../reference/st_tiles_data.html">st_tiles_data</a></span>(id))
<span class="co">#&gt; # A tibble: 9 x 8</span>
<span class="co">#&gt;   id      loc          col   row body   category  zone            species </span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;           &lt;chr&gt;   </span>
<span class="co">#&gt; 1 galaxy1 Earth       2196  2357 Planet Homeworld United Federat~ Human   </span>
<span class="co">#&gt; 2 galaxy1 Romulus     2615  1742 Planet Homeworld Romulan Star E~ Romulan </span>
<span class="co">#&gt; 3 galaxy1 Qo'noS      3310  3361 Planet Homeworld Klingon Empire  Klingon </span>
<span class="co">#&gt; 4 galaxy1 Breen       1004   939 Planet Homeworld Breen Confeder~ Breen   </span>
<span class="co">#&gt; 5 galaxy1 Ferenginar  1431  1996 Planet Homeworld Ferengi Allian~ Ferengi </span>
<span class="co">#&gt; 6 galaxy1 Cardassia   1342  2841 Planet Homeworld Cardassian Uni~ Cardass~</span>
<span class="co">#&gt; 7 galaxy1 Tholia       407  3866 Planet Homeworld Tholian Assemb~ Tholian </span>
<span class="co">#&gt; 8 galaxy1 Tzenketh    1553  2557 Planet Homeworld Tzenkethi Coal~ Tzenket~</span>
<span class="co">#&gt; 9 galaxy1 Talar       1039  3489 Planet Homeworld Talarian Repub~ Talarian</span>
(d &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tile_coords.html">tile_coords</a></span>(d, id))
<span class="co">#&gt; # A tibble: 9 x 10</span>
<span class="co">#&gt;   id      loc          col   row body  category zone  species     x      y</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 galaxy1 Earth       2196  2357 Plan~ Homewor~ Unit~ Human    68.6  -73.7</span>
<span class="co">#&gt; 2 galaxy1 Romulus     2615  1742 Plan~ Homewor~ Romu~ Romulan  81.7  -54.4</span>
<span class="co">#&gt; 3 galaxy1 Qo'noS      3310  3361 Plan~ Homewor~ Klin~ Klingon 103.  -105. </span>
<span class="co">#&gt; 4 galaxy1 Breen       1004   939 Plan~ Homewor~ Bree~ Breen    31.4  -29.3</span>
<span class="co">#&gt; 5 galaxy1 Ferenginar  1431  1996 Plan~ Homewor~ Fere~ Ferengi  44.7  -62.4</span>
<span class="co">#&gt; 6 galaxy1 Cardassia   1342  2841 Plan~ Homewor~ Card~ Cardas~  41.9  -88.8</span>
<span class="co">#&gt; 7 galaxy1 Tholia       407  3866 Plan~ Homewor~ Thol~ Tholian  12.7 -121. </span>
<span class="co">#&gt; 8 galaxy1 Tzenketh    1553  2557 Plan~ Homewor~ Tzen~ Tzenke~  48.5  -79.9</span>
<span class="co">#&gt; 9 galaxy1 Talar       1039  3489 Plan~ Homewor~ Tala~ Talari~  32.5 -109.</span></code></pre></div>
<p>Here is an example using the <code>galaxy1</code> map with <code>leaflet</code>. The <code>st_tiles</code> function is used to link to the tile provider.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(leaflet)
tiles &lt;-<span class="st"> </span><span class="kw"><a href="../reference/st_tiles.html">st_tiles</a></span>(<span class="st">"galaxy1"</span>)
<span class="kw">leaflet</span>(d, <span class="dt">options =</span> <span class="kw">leafletOptions</span>(<span class="dt">crs =</span> <span class="kw">leafletCRS</span>(<span class="st">"L.CRS.Simple"</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">addTiles</span>(tiles) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">setView</span>(<span class="dv">108</span>, <span class="op">-</span><span class="dv">75</span>, <span class="dv">2</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">addCircleMarkers</span>(<span class="dt">lng =</span> <span class="op">~</span>x, <span class="dt">lat =</span> <span class="op">~</span>y, <span class="dt">label =</span> <span class="op">~</span>loc, <span class="dt">color =</span> <span class="st">"white"</span>, <span class="dt">radius =</span> <span class="dv">20</span>)</code></pre></div>
<div id="htmlwidget-af5593a56783c21c0d34" style="width:846.72px;height:528px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-af5593a56783c21c0d34">{"x":{"options":{"crs":{"crsClass":"L.CRS.Simple","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://leonawicz.github.io/tiles/data/st1/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[-73.65625,-54.4375,-105.03125,-29.34375,-62.375,-88.78125,-120.8125,-79.90625,-109.03125],[68.625,81.71875,103.4375,31.375,44.71875,41.9375,12.71875,48.53125,32.46875],20,null,null,{"interactive":true,"className":"","stroke":true,"color":"white","weight":5,"opacity":0.5,"fill":true,"fillColor":"white","fillOpacity":0.2},null,null,null,null,["Earth","Romulus","Qo'noS","Breen","Ferenginar","Cardassia","Tholia","Tzenketh","Talar"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"setView":[[-75,108],2,[]],"limits":{"lat":[-120.8125,-29.34375],"lng":[12.71875,103.4375]}},"evals":[],"jsHooks":[]}</script><p><br></p>
<p>The <code>stSpecies</code> dataset is just a small table that pairs species named with representative thumbnail avatars, mostly pulled from the Memory Alpha website. There is nothing map-related here, but these are used in this <a href="https://leonawicz.github.io/rtrek/articles/sc.html">Stellar Cartography</a> example. It is similar to the Leaflet example above, but a bit more interesting, with markers to click on and information displays.</p>
<p>In the course of the above map-related examples, a few functions have also been introduced. <code>st_tiles</code> takes an <code>id</code> argument that is mapped to the available tile sets in <code>stTiles</code> and returns the relevant URL. <code>st_tiles_data</code> takes the same <code>id</code> argument and returns a simple example data frame containing ancillary data related to the available locations from <code>stGeo</code>. The result is always the same except that the grid cells for locations change with respect to the chosen tile set. Finally, <code>tile_coords</code> can be applied to one of these data frames to add <code>x</code> and <code>y</code> columns for a CRS that Leaflet will understand.</p>
</div>
</div>
<div id="star-trek-api" class="section level2">
<h2 class="hasAnchor">
<a href="#star-trek-api" class="anchor"></a>Star Trek API</h2>
<p>To use the words of the developers, the <a href="http://stapi.co/">STAPI</a> is</p>
<p><em>the first public Star Trek API, accessible via REST and SOAP. It’s an open source project, that anyone can contribute to.</em></p>
<p>The API is highly functional. Please do not abuse the API with constant requests. Their pages suggest no more than one request per second, but I would suggest ten seconds between successive requests. The default anti-DDOS measures in <code>rtrek</code> limit requests to one per second. You can update this global <code>rtrek</code> setting with <code>options</code>, e.g. <code>options(rtrek_antiddos = 10)</code> for a minimum ten second wait between API calls to be an even better neighbor. <code>rtrek</code> will not permit faster requests. If set below one second, the option is ignored and a warning thrown when making any API call.</p>
<div id="stapi-entities" class="section level3">
<h3 class="hasAnchor">
<a href="#stapi-entities" class="anchor"></a>STAPI entities</h3>
<p>There a many fields, or entities, available in the API. The available IDs can be found in this table:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stapiEntities
<span class="co">#&gt; # A tibble: 40 x 4</span>
<span class="co">#&gt;    id                 class   ncol colnames  </span>
<span class="co">#&gt;    &lt;chr&gt;              &lt;chr&gt;  &lt;int&gt; &lt;list&gt;    </span>
<span class="co">#&gt;  1 animal             tbl_df     7 &lt;chr [7]&gt; </span>
<span class="co">#&gt;  2 astronomicalObject tbl_df     5 &lt;chr [5]&gt; </span>
<span class="co">#&gt;  3 book               tbl_df    24 &lt;chr [24]&gt;</span>
<span class="co">#&gt;  4 bookCollection     tbl_df    10 &lt;chr [10]&gt;</span>
<span class="co">#&gt;  5 bookSeries         tbl_df    11 &lt;chr [11]&gt;</span>
<span class="co">#&gt;  6 character          tbl_df    24 &lt;chr [24]&gt;</span>
<span class="co">#&gt;  7 comicCollection    tbl_df    14 &lt;chr [14]&gt;</span>
<span class="co">#&gt;  8 comics             tbl_df    15 &lt;chr [15]&gt;</span>
<span class="co">#&gt;  9 comicSeries        tbl_df    15 &lt;chr [15]&gt;</span>
<span class="co">#&gt; 10 comicStrip         tbl_df    12 &lt;chr [12]&gt;</span>
<span class="co">#&gt; # ... with 30 more rows</span></code></pre></div>
<p>These ID values are passed to <code>stapi</code> to perform a search using the API. The other columns provide some information about the object returned from a search. All entity searches return tibble data frames. You can inspect or unnest the column names of each table returned from every available entity search so you can see beforehand what variables are associated with each entity.</p>
</div>
<div id="accessing-the-api" class="section level3">
<h3 class="hasAnchor">
<a href="#accessing-the-api" class="anchor"></a>Accessing the API</h3>
<p>Using <code>stapi</code> should be thought of as a three part process:</p>
<ul>
<li>Determine how many pages of results exist for a particular entity search.</li>
<li>Only after taking care to do the previous step, perform the search to return search results.</li>
<li>If satellite data is needed on a unique observation in the search results, call <code>stapi</code> one more time referencing the specific observation.</li>
</ul>
<p>To determine how many pages of results exist for a given search, set <code>page_count = TRUE</code>. The impact on the API will be equivalent to only searching a single page of results. One page contains metadata including the total number of pages. Nothing is returned in this “safe mode”, but the total number of search results available is printed to the console.</p>
<p>Searching movies only returns one page of results. However, there are a lot of characters in the Star Trek universe. Check the total pages available for character search.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/stapi.html">stapi</a></span>(<span class="st">"character"</span>, <span class="dt">page_count =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt; Total pages to retrieve all results: 62</span></code></pre></div>
<p>And that is with 100 results per page!</p>
<p>The default <code>page = 1</code> only returns the first page. <code>page</code> can be a vector, e.g. <code>page = 1:62</code>. Results from multi-page searches are automatically combined into a single, constant data frame output. For the second call to <code>stapi</code>, return only page two here, which contains the character, Q (currently, pending future character database updates that may shift the indexing). In case that does change and Q is not always near the top of page two of the search results, the example further below hard-codes his unique/universal ID.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/stapi.html">stapi</a></span>(<span class="st">"character"</span>, <span class="dt">page =</span> <span class="dv">2</span>)
<span class="co">#&gt; # A tibble: 100 x 24</span>
<span class="co">#&gt;    uid     name    gender yearOfBirth monthOfBirth dayOfBirth placeOfBirth</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;        &lt;int&gt;        &lt;int&gt;      &lt;int&gt; &lt;lgl&gt;       </span>
<span class="co">#&gt;  1 CHMA00~ Fuller  M               NA           NA         NA NA          </span>
<span class="co">#&gt;  2 CHMA00~ Burkus  M               NA           NA         NA NA          </span>
<span class="co">#&gt;  3 CHMA00~ Masaka~ &lt;NA&gt;            NA           NA         NA NA          </span>
<span class="co">#&gt;  4 CHMA00~ Thorne  M               NA           NA         NA NA          </span>
<span class="co">#&gt;  5 CHMA00~ Ah-Kel  M               NA           NA         NA NA          </span>
<span class="co">#&gt;  6 CHMA00~ Robert~ &lt;NA&gt;            NA           NA         NA NA          </span>
<span class="co">#&gt;  7 CHMA00~ Q       M               NA           NA         NA NA          </span>
<span class="co">#&gt;  8 CHMA00~ John D~ &lt;NA&gt;            NA           NA         NA NA          </span>
<span class="co">#&gt;  9 CHMA00~ Louis ~ &lt;NA&gt;            NA           NA         NA NA          </span>
<span class="co">#&gt; 10 CHMA00~ Marat ~ M               NA           NA         NA NA          </span>
<span class="co">#&gt; # ... with 90 more rows, and 17 more variables: yearOfDeath &lt;int&gt;,</span>
<span class="co">#&gt; #   monthOfDeath &lt;lgl&gt;, dayOfDeath &lt;lgl&gt;, placeOfDeath &lt;lgl&gt;,</span>
<span class="co">#&gt; #   height &lt;int&gt;, weight &lt;int&gt;, deceased &lt;lgl&gt;, bloodType &lt;chr&gt;,</span>
<span class="co">#&gt; #   maritalStatus &lt;chr&gt;, serialNumber &lt;chr&gt;, hologramActivationDate &lt;chr&gt;,</span>
<span class="co">#&gt; #   hologramStatus &lt;chr&gt;, hologramDateStatus &lt;lgl&gt;, hologram &lt;lgl&gt;,</span>
<span class="co">#&gt; #   fictionalCharacter &lt;lgl&gt;, mirror &lt;lgl&gt;, alternateReality &lt;lgl&gt;</span></code></pre></div>
<p>Character tables can be sparse. There are a lot of variables, many of which will contain missing data for rare, esoteric characters. Even for more popular characters about whom much more universe lore has been uncovered, it still takes dedicated nerds to enter all the data in a database.</p>
<p>When a dataset contains a <code>uid</code> column, this can be used subsequently to extract a satellite dataset about that particular observation that was returned in the original search. First you used safe mode, then search mode, and now switch from search mode to extraction mode to obtain data about Q, specifically. All that is required to do this is pass Q’s <code>uid</code> to <code>stapi</code> and call the function one last time. When <code>uid</code> is no longer <code>NULL</code>, <code>stapi</code> knows not to bother with a search and makes a different type of API call requesting information about the uniquely identified entry.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Q &lt;-<span class="st"> "CHMA0000025118"</span>
Q &lt;-<span class="st"> </span><span class="kw"><a href="../reference/stapi.html">stapi</a></span>(<span class="st">"character"</span>, <span class="dt">uid =</span> Q)

<span class="kw">library</span>(dplyr)
Q<span class="op">$</span>episodes <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(uid, title, stardateFrom, stardateTo)
<span class="co">#&gt;              uid                 title stardateFrom stardateTo</span>
<span class="co">#&gt; 1 EPMA0000001458    All Good Things...      47988.0    47988.0</span>
<span class="co">#&gt; 2 EPMA0000001329                 Q Who      42761.3    42761.3</span>
<span class="co">#&gt; 3 EPMA0000000483 Encounter at Farpoint      41153.7    41153.7</span>
<span class="co">#&gt; 4 EPMA0000162588            Death Wish           NA         NA</span>
<span class="co">#&gt; 5 EPMA0000001510    The Q and the Grey      50384.2    50392.7</span>
<span class="co">#&gt; 6 EPMA0000000845                Q-Less      46531.2    46531.2</span>
<span class="co">#&gt; 7 EPMA0000000651              Tapestry           NA         NA</span>
<span class="co">#&gt; 8 EPMA0000001413                True Q      46192.3    46192.3</span>
<span class="co">#&gt; 9 EPMA0000001377                  Qpid      44741.9    44741.9</span></code></pre></div>
<p>The data returned on Q is actually a large list, including multiple data frames. For simplicity only a piece of it is shown above.</p>
</div>
</div>
<div id="star-trek-novel-text-mining" class="section level2">
<h2 class="hasAnchor">
<a href="#star-trek-novel-text-mining" class="anchor"></a>Star Trek novel text mining</h2>
<p>This section will be continued in a future version of <code>rtrek</code>. For now what is available is a dataset <code>stBooks</code> that compliments the <code>stBooksWP</code> dataset seen earlier. <code>stBooks</code> has a similar number of metadata entries for Star Trek books and there is considerable overlap between the two datasets. However, there are also considerable differences in entries as well as formatting.</p>
<p>This dataset represents metadata parsed, imperfectly but painstakingly thoroughly, from actual Star Trek books. Compared to <code>stBooksWP</code>, which represents a scraping of Wikipedia information on Star Trek books, <code>stBooks</code> contains several different fields, including more useful fields for analysts such as the number of words and chapters in a book.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stBooks
<span class="co">#&gt; # A tibble: 743 x 11</span>
<span class="co">#&gt;    title  creator date  publisher identifier series subseries nchap  nword</span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt;     &lt;int&gt;  &lt;int&gt;</span>
<span class="co">#&gt;  1 The M~ Gene R~ 1979~ Simon an~ 978074341~ The O~ TOS 01 -~    30  54522</span>
<span class="co">#&gt;  2 Dread~ Diane ~ 1986~ Pocket B~ 978074341~ The O~ TOS 29 -~    15  58867</span>
<span class="co">#&gt;  3 Battl~ Diane ~ 1986~ Simon an~ 978074341~ The O~ TOS 31 -~    13  80159</span>
<span class="co">#&gt;  4 The T~ Barbar~ 1988~ Simon an~ 978074341~ The O~ TOS 41 -~    13  71465</span>
<span class="co">#&gt;  5 Home ~ Dana K~ 1990~ Simon an~ 978074342~ The O~ TOS 52 -~    52  68778</span>
<span class="co">#&gt;  6 Ghost~ Barbar~ 1991~ Simon an~ 0743420047 The O~ TOS 53 -~    21  80103</span>
<span class="co">#&gt;  7 First~ Diane ~ 1995~ Pocket B~ 978074342~ The O~ TOS 75 -~    45 110913</span>
<span class="co">#&gt;  8 The A~ Dayton~ 2002~ Pocket B~ 978074346~ The O~ TOS - Th~     1   7439</span>
<span class="co">#&gt;  9 World~ Judith~ 2003~ Pocket B~ 0743488148 The O~ TOS - Wo~    64 207246</span>
<span class="co">#&gt; 10 Duty,~ Noveli~ 2004~ Pocket B~ 978074349~ The O~ TOS - Du~    42 196779</span>
<span class="co">#&gt; # ... with 733 more rows, and 2 more variables: nchar &lt;int&gt;,</span>
<span class="co">#&gt; #   dedication &lt;chr&gt;</span></code></pre></div>
<p>Obviously, licensed book content itself cannot be shared as data, so it is not possible to provide capability in <code>rtrek</code> to enable analysts to perform their own unique text mining analyses on Star Trek novel corpura. However, future versions of <code>rtrek</code> will include more summary datasets that will aim to represent more intersting variables. Just a couple examples could be the relative frequency of popular characters’ names per book, or a senitment analysis, or any other set of interesting metrics that could be used to inform suggested reading lists of various tiles or books by particular authors with a favored style or focus.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#local-datasets">Local datasets</a></li>
      <li><a href="#star-trek-api">Star Trek API</a></li>
      <li><a href="#star-trek-novel-text-mining">Star Trek novel text mining</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://leonawicz.github.io/">Matthew Leonawicz</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
